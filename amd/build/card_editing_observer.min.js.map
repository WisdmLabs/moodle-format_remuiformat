{"version":3,"sources":["card_editing_observer.js"],"names":["define","$","Ajax","Templates","Notification","SELECTORS","GENERAL_ROOT","ACTIVITY","COURSE_PROGRESS","PROMISES","GET_COURSE_PROGRESS","courseid","call","methodname","args","init","document","bind","event","container","target","is","data","done","response","render","html","js","replaceNode","fail","exception"],"mappings":"AAAAA,OAAO,CAAC,SAAU,YAAa,iBAAkB,qBAAsB,SAASC,EAAGC,EAAMC,EAAWC,GAMnG,IAAIC,EAAY,CACfC,aAAc,mBACdC,SAAU,cACVC,gBAAiB,6BAOdC,EAAW,CAKdC,oBAAqB,SAASC,GAC7B,OAAOT,EAAKU,KAAK,CAAC,CACLC,WAAY,0CACZC,KAAM,CACFH,SAAUA,MAEd,KAkCZ,MAAO,CACHI,KAVJ,WACId,EAAEe,UAAUC,KAAK,iBAAkB,SAASC,GAnBhD,IACQC,EACAR,EAkBIV,EAAEiB,EAAME,QAAQC,GAAG,iBAnBvBF,EAAYlB,EAAEI,EAAUC,aAAe,IAAMD,EAAUG,iBACvDG,EAAWQ,EAAUG,KAAK,YAC9Bb,EAASC,oBAAoBC,GAC5BY,KAAK,SAASC,GACXA,EAASb,SAAWA,EACpBR,EAAUsB,OAAO,qCAAsCD,GACtDD,KAAK,SAASG,EAAMC,GACjBxB,EAAUyB,YAAYT,EAAWO,EAAMC,KAE1CE,KAAKzB,EAAa0B,aAEtBD,KAAKzB,EAAa0B","sourcesContent":["define(['jquery', 'core/ajax', 'core/templates', 'core/notification'], function($, Ajax, Templates, Notification) {\n\n    /**\n     * element SELECTORS list\n     * @type {Object}\n     */\n\tvar SELECTORS = {\n\t\tGENERAL_ROOT: '.general-section',\n\t\tACTIVITY: 'li.activity',\n\t\tCOURSE_PROGRESS: '.course-prgress-container'\n\t};\n\n    /**\n     * Ajax PROMISES\n     * @type {Object}\n     */\n\tvar PROMISES = {\n        /**\n         * GET_COURSE_PROGRESS promise call\n         * @param {Integer} courseid Course id\n         */\n\t\tGET_COURSE_PROGRESS: function(courseid) {\n\t\t\treturn Ajax.call([{\n                methodname: 'format_remuiformat_course_progress_data',\n                args: {\n                    courseid: courseid\n                }\n            }])[0];\n\t\t}\n\t};\n\n    /**\n     * Update course progress when activity duplicated or deleted\n     */\n    function update_course_progress() {\n        var container = $(SELECTORS.GENERAL_ROOT + ' ' + SELECTORS.COURSE_PROGRESS);\n        var courseid = container.data('courseid');\n        PROMISES.GET_COURSE_PROGRESS(courseid)\n        .done(function(response) {\n            response.courseid = courseid;\n            Templates.render('format_remuiformat/course_progress', response)\n            .done(function(html, js) {\n                Templates.replaceNode(container, html, js);\n            })\n            .fail(Notification.exception);\n        })\n        .fail(Notification.exception);\n    }\n\n    /**\n     * Initialize js\n     */\n    function init() {\n        $(document).bind('DOMNodeRemoved', function(event) {\n            if ($(event.target).is('li.activity')) {\n                update_course_progress();\n            }\n        });\n    }\n\n    // Must return the init function.\n    return {\n        init: init\n    };\n});\n"],"file":"card_editing_observer.min.js"}